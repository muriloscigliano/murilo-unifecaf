---
interface Props {
  src: string;
  alt: string;
  class?: string;
}

const { src, alt, class: className = "" } = Astro.props;
---

<div class={`w-full my-12 flex justify-center ${className}`}>
  <div class="w-full max-w-[1200px] bg-[var(--muted)]/30 rounded-[36px] overflow-hidden fade-in-image" data-fade-in-image>
    <img
      src={src}
      alt={alt}
      class="w-full h-[700px] rounded-[36px] object-cover"
      loading="lazy"
    />
  </div>
</div>

<script>
  (function() {
    if (typeof window === 'undefined') return;
    
    const initImageAnimation = () => {
      const images = document.querySelectorAll('[data-fade-in-image]');
      
      if (images.length === 0) return;
      
      const observer = new IntersectionObserver(
        (entries) => {
          entries.forEach((entry) => {
            if (entry.isIntersecting) {
              entry.target.classList.add('is-visible');
              observer.unobserve(entry.target);
            }
          });
        },
        { threshold: 0.15, rootMargin: '0px 0px -100px 0px' }
      );

      images.forEach((img) => observer.observe(img));
    };

    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', initImageAnimation);
    } else {
      initImageAnimation();
    }
  })();
</script>

<style>
  .fade-in-image {
    opacity: 0;
    transform: translateY(30px);
    transition: opacity 0.8s ease-out, transform 0.8s ease-out;
  }

  .fade-in-image.is-visible {
    opacity: 1;
    transform: translateY(0);
  }
</style>
